<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>腾讯弹幕数据分析实战 | Lovers 的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/lzmblog/lzmblog/favicon.ico">
    <link rel="stylesheet" href="/lzmblog/style.css">
    <meta name="description" content="个人博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/lzmblog/assets/css/0.styles.34e16441.css" as="style"><link rel="preload" href="/lzmblog/assets/js/app.f6582fa6.js" as="script"><link rel="preload" href="/lzmblog/assets/js/7.f579b280.js" as="script"><link rel="preload" href="/lzmblog/assets/js/4.393c1c4d.js" as="script"><link rel="prefetch" href="/lzmblog/assets/js/10.7063497e.js"><link rel="prefetch" href="/lzmblog/assets/js/11.c077aed5.js"><link rel="prefetch" href="/lzmblog/assets/js/12.3dc9bdbf.js"><link rel="prefetch" href="/lzmblog/assets/js/13.8c8bc62d.js"><link rel="prefetch" href="/lzmblog/assets/js/14.158e06d6.js"><link rel="prefetch" href="/lzmblog/assets/js/15.5cfac5ee.js"><link rel="prefetch" href="/lzmblog/assets/js/16.87fbfa73.js"><link rel="prefetch" href="/lzmblog/assets/js/17.7c036072.js"><link rel="prefetch" href="/lzmblog/assets/js/18.82e55eab.js"><link rel="prefetch" href="/lzmblog/assets/js/19.9dff5288.js"><link rel="prefetch" href="/lzmblog/assets/js/2.672cc620.js"><link rel="prefetch" href="/lzmblog/assets/js/20.a3f1c967.js"><link rel="prefetch" href="/lzmblog/assets/js/21.3ff5f263.js"><link rel="prefetch" href="/lzmblog/assets/js/22.89c469f1.js"><link rel="prefetch" href="/lzmblog/assets/js/23.38743dcf.js"><link rel="prefetch" href="/lzmblog/assets/js/24.6bcac6e8.js"><link rel="prefetch" href="/lzmblog/assets/js/25.28974017.js"><link rel="prefetch" href="/lzmblog/assets/js/26.d9e15335.js"><link rel="prefetch" href="/lzmblog/assets/js/27.8a39c8f2.js"><link rel="prefetch" href="/lzmblog/assets/js/28.a01661e8.js"><link rel="prefetch" href="/lzmblog/assets/js/29.a4a5406a.js"><link rel="prefetch" href="/lzmblog/assets/js/3.0e874f07.js"><link rel="prefetch" href="/lzmblog/assets/js/30.355f61f5.js"><link rel="prefetch" href="/lzmblog/assets/js/31.4e589136.js"><link rel="prefetch" href="/lzmblog/assets/js/32.0a74b181.js"><link rel="prefetch" href="/lzmblog/assets/js/33.1f0a784e.js"><link rel="prefetch" href="/lzmblog/assets/js/34.13798fc1.js"><link rel="prefetch" href="/lzmblog/assets/js/35.ce17e3ed.js"><link rel="prefetch" href="/lzmblog/assets/js/36.bafc423d.js"><link rel="prefetch" href="/lzmblog/assets/js/37.25f39385.js"><link rel="prefetch" href="/lzmblog/assets/js/38.c4bf83e1.js"><link rel="prefetch" href="/lzmblog/assets/js/39.1c904ce9.js"><link rel="prefetch" href="/lzmblog/assets/js/5.f28696c6.js"><link rel="prefetch" href="/lzmblog/assets/js/6.22e81d8d.js"><link rel="prefetch" href="/lzmblog/assets/js/8.bfecf23e.js"><link rel="prefetch" href="/lzmblog/assets/js/9.3b6d93a9.js">
    <link rel="stylesheet" href="/lzmblog/assets/css/0.styles.34e16441.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout" data-v-7f2e4136><header class="header-container" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/lzmblog/post-bg.jpeg);" data-v-93921ff8 data-v-7f2e4136><nav class="navbar" style="position:absolute;opacity:1;transition:all 0.5s ease-in-out;" data-v-93921ff8><a href="/lzmblog/" class="navbar-link router-link-active">
    Lovers Blog
  </a> <ul class="navbar-links"><li><a href="/lzmblog/" class="router-link-active">
        HOME
      </a></li><li><a href="/lzmblog/about/">
        ABOUT
      </a></li><li><a href="/lzmblog/tags/">
        TAGS
      </a></li></ul> <div id="nav-icon"><span></span><span></span><span></span></div></nav> <div class="header-title" data-v-93921ff8 data-v-93921ff8><h1 data-v-93921ff8>腾讯弹幕数据分析实战</h1> <p data-v-93921ff8></p></div></header> <div class="container" data-v-b3fda33c data-v-7f2e4136><main class="main" style="width:60%;" data-v-b3fda33c><div class="post" data-v-b3fda33c data-v-b3fda33c><article class="main-div"><div class="post-content content content__default"><p>腾讯弹幕数据分析实战</p> <h1 id="通用爬虫代码"><a href="#通用爬虫代码" class="header-anchor">#</a> 通用爬虫代码：</h1> <div class="language-python extra-class"><pre class="language-python"><code><span class="token triple-quoted-string string">'''
Date: 2020-12-21 23:27:59
LastEditTime: 2020-12-22 16:36:43
'''</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> json
<span class="token keyword">import</span> time
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
  

<span class="token keyword">def</span> <span class="token function">get_danmu_all_page</span><span class="token punctuation">(</span>target_id<span class="token punctuation">,</span> vid<span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#亲测有效</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36'</span><span class="token punctuation">}</span>
        url <span class="token operator">=</span> <span class="token string">'https://mfm.video.qq.com/danmu?otype=json&amp;timestamp={0}&amp;target_id={1}vid{2}&amp;count=80'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span>target_id<span class="token punctuation">,</span>vid<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;正在提取第&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;页&quot;</span><span class="token punctuation">)</span>
        html <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>
        bs <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">.</span>text<span class="token punctuation">,</span>strict <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment">#strict参数解决部分内容json格式解析报错</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        <span class="token comment">#遍历获取目标字段</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> bs<span class="token punctuation">[</span><span class="token string">'comments'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                opername <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token string">'opername'</span><span class="token punctuation">]</span>
                content <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span>  <span class="token comment">#弹幕</span>
                upcount <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token string">'upcount'</span><span class="token punctuation">]</span>  <span class="token comment">#点赞数</span>
                user_degree <span class="token operator">=</span>i<span class="token punctuation">[</span><span class="token string">'uservip_degree'</span><span class="token punctuation">]</span> <span class="token comment">#会员等级</span>
                timepoint <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token string">'timepoint'</span><span class="token punctuation">]</span>  <span class="token comment">#发布时间</span>
                comment_id <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token string">'commentid'</span><span class="token punctuation">]</span>  <span class="token comment">#弹幕id</span>
                cache <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'用户id'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>opername<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'弹幕'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>content<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'会员等级'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>user_degree<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'发布时间'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>timepoint<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'弹幕点赞'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>upcount<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'弹幕id'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>comment_id<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df<span class="token punctuation">,</span>cache<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    <span class="token comment"># df.to_csv(f'{filename}.csv',encoding = 'utf-8')</span>
    <span class="token keyword">return</span> df
<span class="token comment">#自己按需添加</span>
target_id <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'6130942571%26'</span><span class="token punctuation">,</span><span class="token string">'6164313448%26'</span><span class="token punctuation">,</span><span class="token string">'6194952391%26'</span><span class="token punctuation">,</span><span class="token string">'6227063464%26'</span><span class="token punctuation">]</span>
vid <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'%3Dt0034o74jpr'</span><span class="token punctuation">,</span><span class="token string">'%3Dr00346rvwyq'</span><span class="token punctuation">,</span><span class="token string">'%3Dd0035rctvoh'</span><span class="token punctuation">,</span><span class="token string">'%3Db0035j0tgo0'</span><span class="token punctuation">]</span>
filename <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'面试篇'</span><span class="token punctuation">,</span><span class="token string">'第1期'</span><span class="token punctuation">,</span><span class="token string">'第2期'</span><span class="token punctuation">,</span><span class="token string">'第3期'</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>vid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> get_danmu_all_page<span class="token punctuation">(</span>target_id<span class="token operator">=</span>target_id<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> vid<span class="token operator">=</span>vid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>filename<span class="token operator">=</span>filename<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#df{}.format(data_dm[i])</span>
    df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'所属期数'</span><span class="token punctuation">,</span> filename<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>filename<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">.csv'</span></span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

</code></pre></div><h1 id="令人心动的offer2可视化分析"><a href="#令人心动的offer2可视化分析" class="header-anchor">#</a> 令人心动的offer2可视化分析</h1> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pyecharts<span class="token punctuation">.</span>options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span><span class="token builtin">globals</span> <span class="token keyword">import</span> ThemeType
</code></pre></div><h2 id="批量导入数据并合并"><a href="#批量导入数据并合并" class="header-anchor">#</a> 批量导入数据并合并</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># path = 'D:/Pandas/csv/'</span>
<span class="token comment"># #文件目录路径</span>
<span class="token comment"># df_all = pd.DataFrame()</span>
<span class="token comment"># for i in os.listdir(path):</span>
<span class="token comment">#     df_one = pd.read_csv(path+f'{i}', engine='python', encoding='utf-8')  </span>
<span class="token comment">#     df_all = df_all.append(df_one, ignore_index=False)#ignore_index：默认值为False，如果为True则不使用index标签</span>
<span class="token comment"># df_all.shape</span>
<span class="token comment"># #输出</span>
<span class="token comment"># df_all.to_excel('offer.xlsx',index=False)</span>
</code></pre></div><h2 id="数据读取"><a href="#数据读取" class="header-anchor">#</a> 数据读取</h2> <div class="language-python extra-class"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'offer.xlsx'</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>所属期数</th> <th>用户id</th> <th>弹幕</th> <th>会员等级</th> <th>发布时间</th> <th>弹幕点赞</th> <th>弹幕id</th></tr></thead> <tbody><tr><th>0</th> <td>第1期</td> <td>NaN</td> <td>47，第一来了</td> <td>4</td> <td>5</td> <td>23</td> <td>6732257356663684096</td></tr> <tr><th>1</th> <td>第1期</td> <td>NaN</td> <td>第一</td> <td>1</td> <td>8</td> <td>5</td> <td>6732257393620750336</td></tr> <tr><th>2</th> <td>第1期</td> <td>NaN</td> <td>哈哈哈，我还以为我是第一个呢</td> <td>1</td> <td>7</td> <td>32</td> <td>6732257548063721472</td></tr> <tr><th>3</th> <td>第1期</td> <td>NaN</td> <td>YEYEYEY</td> <td>0</td> <td>8</td> <td>16</td> <td>6732257672952315904</td></tr> <tr><th>4</th> <td>第1期</td> <td>NaN</td> <td>来了来了，</td> <td>6</td> <td>6</td> <td>18</td> <td>6732258003787425792</td></tr> <tr><th>5</th> <td>第1期</td> <td>叶湘伦</td> <td>来了</td> <td>0</td> <td>8</td> <td>0</td> <td>6732258629720189952</td></tr> <tr><th>6</th> <td>第1期</td> <td>NaN</td> <td>来了来了</td> <td>0</td> <td>8</td> <td>2</td> <td>6732258673319944192</td></tr> <tr><th>7</th> <td>第1期</td> <td>海浪</td> <td>来啦</td> <td>0</td> <td>8</td> <td>0</td> <td>6732258806970479616</td></tr> <tr><th>8</th> <td>第1期</td> <td>NaN</td> <td>来咯</td> <td>0</td> <td>5</td> <td>4</td> <td>6732258885488543744</td></tr> <tr><th>9</th> <td>第1期</td> <td>熙崽是神仙</td> <td>第一！</td> <td>0</td> <td>7</td> <td>9</td> <td>6732260786762655744</td></tr></tbody></table></div> <h2 id="数据处理及清洗"><a href="#数据处理及清洗" class="header-anchor">#</a> 数据处理及清洗</h2> <h3 id="重命名"><a href="#重命名" class="header-anchor">#</a> 重命名</h3> <p>所属期数 episodes   用户id user     弹幕 comment    会员等级 grade  发布时间 date   弹幕点赞 likecounts     弹幕id dmid</p> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'所属期数'</span><span class="token punctuation">:</span><span class="token string">'episodes'</span><span class="token punctuation">,</span><span class="token string">'用户id'</span><span class="token punctuation">:</span><span class="token string">'user'</span><span class="token punctuation">,</span><span class="token string">'弹幕'</span><span class="token punctuation">:</span><span class="token string">'comment'</span><span class="token punctuation">,</span><span class="token string">'会员等级'</span><span class="token punctuation">:</span><span class="token string">'grade'</span><span class="token punctuation">,</span><span class="token string">'发布时间'</span><span class="token punctuation">:</span><span class="token string">'date'</span><span class="token punctuation">,</span><span class="token string">'弹幕点赞'</span><span class="token punctuation">:</span><span class="token string">'likecounts'</span><span class="token punctuation">,</span><span class="token string">'弹幕id'</span><span class="token punctuation">:</span><span class="token string">'dmid'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>episodes</th> <th>user</th> <th>comment</th> <th>grade</th> <th>date</th> <th>likecounts</th> <th>dmid</th></tr></thead> <tbody><tr><th>0</th> <td>第1期</td> <td>NaN</td> <td>47，第一来了</td> <td>4</td> <td>5</td> <td>23</td> <td>6732257356663684096</td></tr> <tr><th>1</th> <td>第1期</td> <td>NaN</td> <td>第一</td> <td>1</td> <td>8</td> <td>5</td> <td>6732257393620750336</td></tr> <tr><th>2</th> <td>第1期</td> <td>NaN</td> <td>哈哈哈，我还以为我是第一个呢</td> <td>1</td> <td>7</td> <td>32</td> <td>6732257548063721472</td></tr> <tr><th>3</th> <td>第1期</td> <td>NaN</td> <td>YEYEYEY</td> <td>0</td> <td>8</td> <td>16</td> <td>6732257672952315904</td></tr> <tr><th>4</th> <td>第1期</td> <td>NaN</td> <td>来了来了，</td> <td>6</td> <td>6</td> <td>18</td> <td>6732258003787425792</td></tr></tbody></table></div> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 70798 entries, 0 to 70797
Data columns (total 7 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   episodes    70798 non-null  object
 1   user        26409 non-null  object
 2   comment     70797 non-null  object
 3   grade       70798 non-null  int64 
 4   date        70798 non-null  int64 
 5   likecounts  70798 non-null  int64 
 6   dmid        70798 non-null  int64 
dtypes: int64(4), object(3)
memory usage: 3.8+ MB
</code></pre></div><h3 id="过滤字段"><a href="#过滤字段" class="header-anchor">#</a> 过滤字段</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#对用户进行空值补充</span>
df<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'未知用户'</span><span class="token punctuation">)</span>
<span class="token comment">#对弹幕进行re匹配处理</span>
df<span class="token punctuation">[</span><span class="token string">'comment'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'comment'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token string">r&quot;([\u4e00-\u9fa5]+)&quot;</span><span class="token punctuation">)</span> <span class="token comment">#提取中文内容</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#纯表情弹幕直接删除</span>
<span class="token comment">#提取分析字段</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>episodes</th> <th>user</th> <th>comment</th> <th>grade</th> <th>date</th> <th>likecounts</th></tr></thead> <tbody><tr><th>0</th> <td>第1期</td> <td>未知用户</td> <td>第一来了</td> <td>4</td> <td>5</td> <td>23</td></tr> <tr><th>1</th> <td>第1期</td> <td>未知用户</td> <td>第一</td> <td>1</td> <td>8</td> <td>5</td></tr> <tr><th>2</th> <td>第1期</td> <td>未知用户</td> <td>哈哈哈</td> <td>1</td> <td>7</td> <td>32</td></tr> <tr><th>4</th> <td>第1期</td> <td>未知用户</td> <td>来了来了</td> <td>6</td> <td>6</td> <td>18</td></tr> <tr><th>5</th> <td>第1期</td> <td>叶湘伦</td> <td>来了</td> <td>0</td> <td>8</td> <td>0</td></tr></tbody></table></div> <h3 id="时间格式转换"><a href="#时间格式转换" class="header-anchor">#</a> 时间格式转换</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">time_change</span><span class="token punctuation">(</span>seconds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>seconds<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
    h<span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
    ss_time <span class="token operator">=</span> <span class="token string">&quot;%d:%02d:%02d&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>h<span class="token punctuation">,</span> m<span class="token punctuation">,</span> s<span class="token punctuation">)</span>
    <span class="token comment"># print(ss_time)</span>
    <span class="token keyword">return</span> ss_time
<span class="token comment"># time_change(seconds=8888)</span>
<span class="token comment">#将time_change函数应用于date字段：</span>
df<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>time_change<span class="token punctuation">)</span>
<span class="token comment">#设置为需要的时间格式</span>
df<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> x<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="机械压缩函数处理comment"><a href="#机械压缩函数处理comment" class="header-anchor">#</a> 机械压缩函数处理comment</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#定义机械压缩函数</span>
<span class="token keyword">def</span> <span class="token function">yasuo</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> st<span class="token punctuation">[</span>j<span class="token punctuation">:</span>j<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> st<span class="token punctuation">[</span>j<span class="token operator">+</span>i<span class="token punctuation">:</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                k <span class="token operator">=</span> j <span class="token operator">+</span> i
                <span class="token keyword">while</span> st<span class="token punctuation">[</span>k<span class="token punctuation">:</span>k<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> st<span class="token punctuation">[</span>k<span class="token operator">+</span>i<span class="token punctuation">:</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span> <span class="token keyword">and</span> k<span class="token operator">&lt;</span><span class="token builtin">len</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">:</span>   
                    k <span class="token operator">=</span> k <span class="token operator">+</span> i
                st <span class="token operator">=</span> st<span class="token punctuation">[</span><span class="token punctuation">:</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> st<span class="token punctuation">[</span>k<span class="token punctuation">:</span><span class="token punctuation">]</span>    
    <span class="token keyword">return</span> st
<span class="token comment"># yasuo(st='')</span>
<span class="token comment">#调用机械压缩函数</span>
df<span class="token punctuation">[</span><span class="token string">&quot;comment&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;comment&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>yasuo<span class="token punctuation">)</span>
</code></pre></div><h3 id="会员等级打标"><a href="#会员等级打标" class="header-anchor">#</a> 会员等级打标</h3> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>grade<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>[0, 3, 1, 4, 2, 5, 6, 7, 8]
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'v'</span><span class="token operator">+</span>df<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span><span class="token comment">#['v'+i for i in df['grade']]</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>episodes</th> <th>user</th> <th>comment</th> <th>grade</th> <th>date</th> <th>likecounts</th></tr></thead> <tbody><tr><th>9235</th> <td>第1期</td> <td>未知用户</td> <td>王颖飞好像一个演员</td> <td>v0</td> <td>00:27:42</td> <td>5</td></tr> <tr><th>57421</th> <td>面试篇</td> <td>zxz</td> <td>彩虹袜</td> <td>v3</td> <td>00:13:07</td> <td>12</td></tr></tbody></table></div> <h2 id="数据分析"><a href="#数据分析" class="header-anchor">#</a> 数据分析</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#绘图通用函数</span>
<span class="token keyword">def</span> <span class="token function">get_pyechart</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>chart<span class="token punctuation">,</span>title<span class="token punctuation">,</span>size<span class="token punctuation">,</span>pos<span class="token punctuation">,</span>theme<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> chart <span class="token operator">==</span> <span class="token string">'bar'</span><span class="token punctuation">:</span>
        c <span class="token operator">=</span> <span class="token punctuation">(</span>
            Bar<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span> 
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>font_size<span class="token operator">=</span>size<span class="token punctuation">,</span>position<span class="token operator">=</span>pos<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
    <span class="token keyword">elif</span> chart <span class="token operator">==</span> <span class="token string">'barh'</span><span class="token punctuation">:</span>
        c <span class="token operator">=</span> <span class="token punctuation">(</span>
            Bar<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>reversal_axis<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#X轴与y轴调换顺序</span>
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>font_size<span class="token operator">=</span>size<span class="token punctuation">,</span>position<span class="token operator">=</span>pos<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
    <span class="token keyword">elif</span> chart <span class="token operator">==</span> <span class="token string">'pie'</span><span class="token punctuation">:</span>
        c <span class="token operator">=</span> <span class="token punctuation">(</span>
            Pie<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>formatter<span class="token operator">=</span><span class="token string">&quot;等级{b}占比:{d}%&quot;</span><span class="token punctuation">,</span>font_size<span class="token operator">=</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
    <span class="token keyword">elif</span> chart <span class="token operator">==</span> <span class="token string">'line'</span><span class="token punctuation">:</span>
        c <span class="token operator">=</span> <span class="token punctuation">(</span>
            Line<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>theme<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'情感倾向'</span><span class="token punctuation">,</span>y<span class="token punctuation">,</span> is_smooth<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>is_connect_nones<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>areastyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AreaStyleOpts<span class="token punctuation">(</span>opacity<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span>title<span class="token punctuation">,</span>subtitle<span class="token operator">=</span><span class="token string">&quot;数据来源：腾讯视频&quot;</span><span class="token punctuation">,</span>pos_left <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
    c<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span>title<span class="token punctuation">,</span>subtitle<span class="token operator">=</span><span class="token string">&quot;数据来源：腾讯视频&quot;</span><span class="token punctuation">,</span>pos_left <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>font_size<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">#更改横坐标字体大小</span>
                        yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>font_size<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">#更改纵坐标字体大小</span>
                        <span class="token punctuation">)</span>
    <span class="token keyword">return</span> c<span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_1-各期弹幕数量对比"><a href="#_1-各期弹幕数量对比" class="header-anchor">#</a> 1.各期弹幕数量对比</h3> <div class="language-python extra-class"><pre class="language-python"><code>df_e <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'episodes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_e
</code></pre></div><div class="language- extra-class"><pre><code>面试篇    18603
第3期    18107
第1期    17551
第2期    15844
Name: episodes, dtype: int64
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> df_e<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> df_e<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_e <span class="token operator">=</span> get_pyechart<span class="token punctuation">(</span>x<span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>chart<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span>title<span class="token operator">=</span><span class="token string">'各期弹幕数量'</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token string">'top'</span><span class="token punctuation">,</span>theme<span class="token operator">=</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">)</span>
df_e
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/20201222170017411.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzYwOTEy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h3 id="_2-谁是弹幕发射机"><a href="#_2-谁是弹幕发射机" class="header-anchor">#</a> 2.谁是弹幕发射机</h3> <div class="language-python extra-class"><pre class="language-python"><code>df_u <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df_u
</code></pre></div><div class="language- extra-class"><pre><code>神马不是浮云     78
.          79
圣雪天使       80
。          89
白龙吟        92
为时不晚i      93
momo       93
ベ☆小强呐     103
想太多de猫    135
Name: user, dtype: int64
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> df_u<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> df_u<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_u <span class="token operator">=</span> get_pyechart<span class="token punctuation">(</span>x<span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>chart<span class="token operator">=</span><span class="token string">'barh'</span><span class="token punctuation">,</span>title<span class="token operator">=</span><span class="token string">'弹幕发送数量TOP10'</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span>theme<span class="token operator">=</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">)</span>
df_u
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/20201222165950490.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzYwOTEy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">&quot;想太多de猫&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>episodes</th> <th>user</th> <th>comment</th> <th>grade</th> <th>date</th> <th>likecounts</th></tr></thead> <tbody><tr><th>17104</th> <td>第1期</td> <td>想太多de猫</td> <td>爱吃辣的都是美女</td> <td>v4</td> <td>00:51:54</td> <td>9</td></tr> <tr><th>20881</th> <td>第2期</td> <td>想太多de猫</td> <td>如果这都是咸鱼</td> <td>v4</td> <td>00:09:45</td> <td>10</td></tr> <tr><th>1489</th> <td>第1期</td> <td>想太多de猫</td> <td>领带神马的太高端</td> <td>v4</td> <td>00:04:42</td> <td>12</td></tr> <tr><th>5408</th> <td>第1期</td> <td>想太多de猫</td> <td>谦虚不等于诚实哦</td> <td>v4</td> <td>00:15:49</td> <td>12</td></tr> <tr><th>57919</th> <td>面试篇</td> <td>想太多de猫</td> <td>大多数父母的想法</td> <td>v4</td> <td>00:14:54</td> <td>7</td></tr> <tr><th>60506</th> <td>面试篇</td> <td>想太多de猫</td> <td>越看越自卑</td> <td>v4</td> <td>00:21:36</td> <td>13</td></tr> <tr><th>45714</th> <td>第3期</td> <td>想太多de猫</td> <td>这是绝对的高质量对抗</td> <td>v0</td> <td>00:37:00</td> <td>2</td></tr> <tr><th>21397</th> <td>第2期</td> <td>想太多de猫</td> <td>瞿泽林这句对人性的关怀</td> <td>v4</td> <td>00:11:05</td> <td>49</td></tr> <tr><th>59906</th> <td>面试篇</td> <td>想太多de猫</td> <td>假发了解一下</td> <td>v4</td> <td>00:19:53</td> <td>13</td></tr> <tr><th>39564</th> <td>第3期</td> <td>想太多de猫</td> <td>个人觉得直接问更好</td> <td>v0</td> <td>00:21:49</td> <td>1</td></tr></tbody></table></div> <h3 id="_3-会员等级分布"><a href="#_3-会员等级分布" class="header-anchor">#</a> 3.会员等级分布</h3> <div class="language-python extra-class"><pre class="language-python"><code>df_g <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df_g
</code></pre></div><div class="language- extra-class"><pre><code>v8       12
v7      135
v6     1496
v5     2097
v2     2499
v4     2957
v1     3220
v3     3403
v0    54286
Name: grade, dtype: int64
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> df_g<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> df_g<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_g <span class="token operator">=</span> get_pyechart<span class="token punctuation">(</span>x<span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>chart<span class="token operator">=</span><span class="token string">'pie'</span><span class="token punctuation">,</span>title<span class="token operator">=</span><span class="token string">'会员等级分布'</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span>theme<span class="token operator">=</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">)</span>
df_g
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/20201222165917851.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzYwOTEy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h3 id="词云图讨论"><a href="#词云图讨论" class="header-anchor">#</a> 词云图讨论</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> stylecloud
<span class="token keyword">import</span> jieba
<span class="token keyword">import</span> os 
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image <span class="token comment"># 用于在jupyter lab中显示本地图</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 定义分词函数</span>
<span class="token keyword">def</span> <span class="token function">get_cut_words</span><span class="token punctuation">(</span>content_series<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 读入停用词表</span>
    stop_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r&quot;D:/Pandas/已学习/如何制作stylecloud词云？/stop_words.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
            stop_words<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加关键词</span>
    my_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'撒老师'</span><span class="token punctuation">,</span> <span class="token string">'范丞丞'</span><span class="token punctuation">,</span><span class="token string">'第一季'</span><span class="token punctuation">]</span>  
    <span class="token keyword">for</span> i <span class="token keyword">in</span> my_words<span class="token punctuation">:</span>
        jieba<span class="token punctuation">.</span>add_word<span class="token punctuation">(</span>i<span class="token punctuation">)</span> 
    <span class="token comment"># 自定义停用词</span>
    my_stop_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'好像'</span><span class="token punctuation">,</span> <span class="token string">'真的'</span><span class="token punctuation">,</span><span class="token string">'感觉'</span><span class="token punctuation">]</span>   
    stop_words<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>my_stop_words<span class="token punctuation">)</span>               
    <span class="token comment"># 分词</span>
    word_num <span class="token operator">=</span> jieba<span class="token punctuation">.</span>lcut<span class="token punctuation">(</span>content_series<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>cat<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token string">'。'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cut_all<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token comment"># 条件筛选</span>
    word_num_selected <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> word_num <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> stop_words <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> word_num_selected
<span class="token comment"># 绘制词云图</span>
text1 <span class="token operator">=</span> get_cut_words<span class="token punctuation">(</span>content_series<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'comment'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stylecloud<span class="token punctuation">.</span>gen_stylecloud<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>text1<span class="token punctuation">)</span><span class="token punctuation">,</span> max_words<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
                          collocations<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                          font_path<span class="token operator">=</span><span class="token string">'字酷堂清楷体.ttf'</span><span class="token punctuation">,</span>
                          icon_name<span class="token operator">=</span><span class="token string">'fas fa-dog'</span><span class="token punctuation">,</span>
                          size<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>
                          <span class="token comment">#palette='matplotlib.Inferno_9',</span>
                          output_name<span class="token operator">=</span><span class="token string">'offer.png'</span><span class="token punctuation">)</span>
Image<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">'offer.png'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\ADMINI~1\AppData\Local\Temp\jieba.cache
Loading model cost 2.044 seconds.
Prefix dict has been built successfully.
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/20201222165827726.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzYwOTEy,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-PL3JJJhN-1608626592533)(demo-offer_files/demo-offer_39_1.png)]"></p> <h3 id="_4-人物被提及"><a href="#_4-人物被提及" class="header-anchor">#</a> 4.人物被提及</h3> <p>丁辉,詹秋怡,王骁,朱一暄,瞿泽林,李晋晔,王颖飞,刘煜成</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#df.str.contains('')虽然不能用来判断，但是可以进行聚合操作</span>
df_talk <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'丁辉'</span><span class="token punctuation">,</span><span class="token string">'詹秋怡'</span><span class="token punctuation">,</span><span class="token string">'王骁'</span><span class="token punctuation">,</span><span class="token string">'朱一暄'</span><span class="token punctuation">,</span><span class="token string">'瞿泽林'</span><span class="token punctuation">,</span><span class="token string">'李晋晔'</span><span class="token punctuation">,</span><span class="token string">'王颖飞'</span><span class="token punctuation">,</span><span class="token string">'刘煜成'</span><span class="token punctuation">]</span>
dft <span class="token operator">=</span> <span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'comment'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> df_talk<span class="token punctuation">]</span>
df_t <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'people'</span><span class="token punctuation">:</span>df_talk<span class="token punctuation">,</span><span class="token string">'count'</span><span class="token punctuation">:</span>dft<span class="token punctuation">}</span><span class="token punctuation">)</span>
df_t <span class="token operator">=</span> df_t<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> df_t<span class="token punctuation">[</span><span class="token string">'people'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> df_t<span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_t <span class="token operator">=</span> get_pyechart<span class="token punctuation">(</span>x<span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>chart<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span>title<span class="token operator">=</span><span class="token string">'被提及次数'</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token string">'top'</span><span class="token punctuation">,</span>theme<span class="token operator">=</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">)</span>
df_t
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/20201222165725284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzYwOTEy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h3 id="情感分析"><a href="#情感分析" class="header-anchor">#</a> 情感分析</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> paddlehub <span class="token keyword">as</span> hub
<span class="token comment">#这里使用了百度开源的成熟NLP模型来预测情感倾向</span>
senta <span class="token operator">=</span> hub<span class="token punctuation">.</span>Module<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;senta_bilstm&quot;</span><span class="token punctuation">)</span>
texts <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'comment'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
input_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'text'</span><span class="token punctuation">:</span>texts<span class="token punctuation">}</span>
res <span class="token operator">=</span> senta<span class="token punctuation">.</span>sentiment_classify<span class="token punctuation">(</span>data<span class="token operator">=</span>input_data<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'pos'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token string">'positive_probs'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> res<span class="token punctuation">]</span>
<span class="token comment">#重采样至15分钟</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> df<span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">'15min'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># #给数据表添加调色板</span>
<span class="token comment"># import seaborn as sns</span>
<span class="token comment"># color_map = sns.light_palette('orange', as_cmap=True)  #light_palette调色板</span>
<span class="token comment"># data.style.background_gradient(color_map)</span>
</code></pre></div><div class="language- extra-class"><pre><code>[2020-12-22 16:27:46,410] [    INFO] - Installing senta_bilstm module
[2020-12-22 16:27:46,436] [    INFO] - Module senta_bilstm already installed in C:\Users\Administrator\.paddlehub\modules\senta_bilstm
[2020-12-22 16:27:57,111] [    INFO] - Installing lac module
[2020-12-22 16:27:57,579] [    INFO] - Module lac already installed in C:\Users\Administrator\.paddlehub\modules\lac
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&quot;pos&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df_p <span class="token operator">=</span> get_pyechart<span class="token punctuation">(</span>x<span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>chart<span class="token operator">=</span><span class="token string">'line'</span><span class="token punctuation">,</span>title<span class="token operator">=</span><span class="token string">'情感倾向'</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token string">'top'</span><span class="token punctuation">,</span>theme<span class="token operator">=</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">)</span>
df_p
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/20201222170041469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzYwOTEy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h1 id="数据集"><a href="#数据集" class="header-anchor">#</a> 数据集：</h1> <p>链接：<a href="https://pan.baidu.com/s/1p4O8-SF-IVqnJkH-5Fp3jw" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1p4O8-SF-IVqnJkH-5Fp3jw
<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>提取码：love
复制这段内容后打开百度网盘手机App，操作更方便哦</p> <h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h1> <p>情感分析会比较耗时间</p></div></article> <div class="main-div vssue"><!----></div></div></main> <aside class="aside" data-v-b3fda33c data-v-b3fda33c><div class="info-card main-div" data-v-1311ce9e data-v-b3fda33c><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/lzmblog/me.png);" data-v-1311ce9e><img src="/lzmblog/logo.jpg" alt="lzmlovers" class="info-avatar" data-v-1311ce9e></div> <div class="info-card-body" data-v-1311ce9e><section class="info-name" data-v-1311ce9e>
      lzmlovers
    </section> <section class="info-desc" data-v-1311ce9e>Tomorrow will be better<br/>明天会更好</section> <section class="info-contact" data-v-1311ce9e><section data-v-1311ce9e><span data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:1em;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-location" data-v-1311ce9e data-v-1311ce9e></use></svg><span class="info-text" data-v-1311ce9e data-v-1311ce9e>
          YongZhou, China
        </span></span></section> <!----> <section data-v-1311ce9e><span data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:1em;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-email" data-v-1311ce9e data-v-1311ce9e></use></svg><span class="info-text" data-v-1311ce9e data-v-1311ce9e>
          2095793572@qq.com
        </span></span></section></section></div> <div class="info-card-footer" data-v-1311ce9e><p class="footer-sns-link" data-v-1311ce9e><a target="_blank" href="https://blog.csdn.net/qq_44760912" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-csdn" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a><a target="_blank" href="https://weibo.com/u/7747087955" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-weibo" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a><a target="_blank" href="https://www.zhihu.com/people/xiao-zhu-wen-wen-ti" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-zhihu" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a><a target="_blank" href="https://github.com/git123hub121" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-github" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a></p></div></div> <div class="post-toc main-div aside-toc" style="position:relative;top:0;width:0px;" data-v-b3fda33c><h4>- CATALOG</h4> <div class="post-nav-toc"><ul><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#批量导入数据并合并">批量导入数据并合并</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#数据读取">数据读取</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#数据处理及清洗">数据处理及清洗</a><ul><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#重命名">重命名</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#过滤字段">过滤字段</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#时间格式转换">时间格式转换</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#机械压缩函数处理comment">机械压缩函数处理comment</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#会员等级打标">会员等级打标</a></li></ul></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#数据分析">数据分析</a><ul><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#_1-各期弹幕数量对比">1.各期弹幕数量对比</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#_2-谁是弹幕发射机">2.谁是弹幕发射机</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#_3-会员等级分布">3.会员等级分布</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#词云图讨论">词云图讨论</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#_4-人物被提及">4.人物被提及</a></li><li><a href="/lzmblog/posts/2020/12/22/%E8%85%BE%E8%AE%AF%E5%BC%B9%E5%B9%95%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98.html#情感分析">情感分析</a></li></ul></li></ul></div></div></aside></div> <footer class="footer" data-v-7f2e4136><p class="footer-sns-link"><a target="_blank" href="https://blog.csdn.net/qq_44760912" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-csdn"></use></svg></span></a><a target="_blank" href="https://weibo.com/u/7747087955" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-weibo"></use></svg></span></a><a target="_blank" href="https://www.zhihu.com/people/xiao-zhu-wen-wen-ti" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-zhihu"></use></svg></span></a><a target="_blank" href="https://github.com/git123hub121" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-github"></use></svg></span></a></p> <div class="copyright"><span id="custom">Copyright &copy; Lovers Blog 2022 | <a href="https://www.vuepress.cn/" target="_blank">VuePress</a></span> <iframe src="https://ghbtns.com/github-btn.html?user=youdeliang&amp;repo=vuepress-theme-melodydl&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="80px" height="20px" class="footer-btn" style="margin-left: 2px; margin-bottom:-5px;"></iframe></div></footer></div><div class="global-ui"><!----><!----><canvas id="vuepress-canvas-ribbon"></canvas><canvas id="vuepress-canvas-cursor"></canvas><div></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 Lovers 的博客
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><APlayer audio="" fixed="true" mini="true" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer></div></div>
    <script src="/lzmblog/assets/js/app.f6582fa6.js" defer></script><script src="/lzmblog/assets/js/7.f579b280.js" defer></script><script src="/lzmblog/assets/js/4.393c1c4d.js" defer></script>
  </body>
</html>
